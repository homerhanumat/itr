---
title: "Conversion of Class Lists"
author: "Homer White"
date: "June 29, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Note

This document is outmoded.  The Perl file now works without having to be run through R.

## Setup

You need Perl on your computer.  If you are working on Windows and don't want to install Perl, then just do this on the RStudio server.

Create a directory (here we will call it `wwconvert`) and place within it this document and the file `convertGC.pl`.

## Usage

### Get Class List from Portal

On the Portal, go to Class Management and pick your course.  Pick Class list for the desired course and download the list as an Excel File.

Delete the first two rows, then add a column at the end giving the section for the course.  If this is, for example, section A then the column should be all A's.

If you have multiple sections of the same course then you can cut and paste so that all of your students are in one worksheet.

Next  you should save your class list, **as a Tab-Delimited file**, into `wwconvert`. If you did it right, it should have a `.txt` extension. Let's say it is called `myClass.txt`.

### Run it Through R

For some reason I can't get Perl to handle the tab-delimited file correctly when it comes straight from Excel.  But everything works if I run it through R, so that's what we will do for now.

Set your working directory to `wwconvert`.

Now run this code chunk:

```{r}
runThroughR <- function(fname) {
  df <- read.table(fname, header = FALSE, sep = "\t", stringsAsFactors = FALSE)
  newName <- sub("\\.txt$", "_fromR.txt", fname)
  write.table(df, file = newName, sep = "\t", quote = FALSE,
              row.names = FALSE, col.names = FALSE)
}
```


Now run your file thrugh R (modify the name, of course):

```{r}
runThroughR("classList.txt")
```

You get a new tab-delimited file called `classList_fromR.txt`.

### Run through Perl

Now we can convert our file to the `.lst` form required by WeBWorK:

```{r}
system("perl convertGC.pl classList.txt classList.lst")
```

Note that the final argument in the Perl call is the desired name for your class list file.  The only requirement is that it end in `.lst`.

You may now upload `classList.lst` to WeBWorK using the File Manager, and import the students into your course from that file.

